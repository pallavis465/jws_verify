import jwt
import json

f = open('SCV_PowerEdge_Profile_v1.5.json')
payload = json.load(f)
private_key = open('es384priv.pem', 'r').read()

header = {'alg': 'ES384',
         'typ': 'JWT',
         'x5c':["MIIC7TCCAnOgAwIBAgIUdx2dJj72Tr2ZiDmOfThZ5jRJpC8wCgYIKoZIzj0EAwMwgZgxCzAJBgNVBAYTAlVTMQ4wDAYDVQQIDAVUZXhhczETMBEGA1UEBwwKUm91bmQgUm9jazEfMB0GA1UECgwWRGVsbCBUZWNobm9sb2dpZXMgSW5jLjEqMCgGA1UECwwhU2VydmVyIGFuZCBJbmZyYXN0cnVjdHVyZSBTeXN0ZW1zMRcwFQYDVQQDDA5pRFJBQyBTQ1YgUm9vdDAeFw0yMDA4MjUxODM5NDBaFw0zODA4MjQxODM5NDBaMIGuMQswCQYDVQQGEwJVUzEOMAwGA1UECAwFVGV4YXMxEzARBgNVBAcMClJvdW5kIFJvY2sxHzAdBgNVBAoMFkRlbGwgVGVjaG5vbG9naWVzIEluYy4xKjAoBgNVBAsMIVNlcnZlciBhbmQgSW5mcmFzdHJ1Y3R1cmUgU3lzdGVtczEtMCsGA1UEAwwkaURSQUMgU2VjdXJlZCBDb21wb25lbnQgVmVyaWZpY2F0aW9uMHYwEAYHKoZIzj0CAQYFK4EEACIDYgAEDoOY22XWcSrg0TzkTLY+jDAMX4W2bhcnl9xFmUn9i5vbR+a5PIKSg/nu+yMfHPSPxGCymEBVAXxtOzCc/9nsM8mgVKwZTGum2biL+zypZnJ930JBdOgCvSWjL+RV8Vx0o2YwZDAdBgNVHQ4EFgQUB5WZa2AHKfb/0zwF1NpGx9LQ4ikwHwYDVR0jBBgwFoAURUPdegU34dWDj6E6PES8bXUt/64wEgYDVR0TAQH/BAgwBgEB/wIBADAOBgNVHQ8BAf8EBAMCAgQwCgYIKoZIzj0EAwMDaAAwZQIwfOooIe6P8/SF6+rScnOQZwVphaXn8tby+UDAqh0qZ7o5k65YW/57/jBgCbY2kN9pAjEAj6ejcrCqm8Uhon59LYZ99omBhzv/CJ+Om2ojNweAsTZKnWrHlP2OO5UfyEVRfWo/"]
         }

sign = jwt.encode(payload, private_key, algorithm='ES384')
print(sign)
sign_from_jwt = sign.split('.')[2]
print(sign_from_jwt)
###########################################################################################
'''
sign_mod = "eyJ0eXAiOiJKV1QiLCJhbGciOiJFUzI1NiIsIng1YyI6WyJNSUlDN1RDQ0FuT2dBd0lCQWdJVWR4MmRKajcyVHIyWmlEbU9mVGhaNWpSSnBDOHdDZ1lJS29aSXpqMEVBd013Z1pneEN6QUpCZ05WQkFZVEFsVlRNUTR3REFZRFZRUUlEQVZVWlhoaGN6RVRNQkVHQTFVRUJ3d0tVbTkxYm1RZ1VtOWphekVmTUIwR0ExVUVDZ3dXUkdWc2JDQlVaV05vYm05c2IyZHBaWE1nU1c1akxqRXFNQ2dHQTFVRUN3d2hVMlZ5ZG1WeUlHRnVaQ0JKYm1aeVlYTjBjblZqZEhWeVpTQlRlWE4wWlcxek1SY3dGUVlEVlFRRERBNXBSRkpCUXlCVFExWWdVbTl2ZERBZUZ3MHlNREE0TWpVeE9ETTVOREJhRncwek9EQTRNalF4T0RNNU5EQmFNSUd1TVFzd0NRWURWUVFHRXdKVlV6RU9NQXdHQTFVRUNBd0ZWR1Y0WVhNeEV6QVJCZ05WQkFjTUNsSnZkVzVrSUZKdlkyc3hIekFkQmdOVkJBb01Ga1JsYkd3Z1ZHVmphRzV2Ykc5bmFXVnpJRWx1WXk0eEtqQW9CZ05WQkFzTUlWTmxjblpsY2lCaGJtUWdTVzVtY21GemRISjFZM1IxY21VZ1UzbHpkR1Z0Y3pFdE1Dc0dBMVVFQXd3a2FVUlNRVU1nVTJWamRYSmxaQ0JEYjIxd2IyNWxiblFnVm1WeWFXWnBZMkYwYVc5dU1IWXdFQVlIS29aSXpqMENBUVlGSzRFRUFDSURZZ0FFRG9PWTIyWFdjU3JnMFR6a1RMWStqREFNWDRXMmJoY25sOXhGbVVuOWk1dmJSK2E1UElLU2cvbnUreU1mSFBTUHhHQ3ltRUJWQVh4dE96Q2MvOW5zTThtZ1ZLd1pUR3VtMmJpTCt6eXBabko5MzBKQmRPZ0N2U1dqTCtSVjhWeDBvMll3WkRBZEJnTlZIUTRFRmdRVUI1V1phMkFIS2ZiLzB6d0YxTnBHeDlMUTRpa3dId1lEVlIwakJCZ3dGb0FVUlVQZGVnVTM0ZFdEajZFNlBFUzhiWFV0LzY0d0VnWURWUjBUQVFIL0JBZ3dCZ0VCL3dJQkFEQU9CZ05WSFE4QkFmOEVCQU1DQWdRd0NnWUlLb1pJemowRUF3TURhQUF3WlFJd2ZPb29JZTZQOC9TRjYrclNjbk9RWndWcGhhWG44dGJ5K1VEQXFoMHFaN281azY1WVcvNTcvakJnQ2JZMmtOOXBBakVBajZlamNyQ3FtOFVob241OUxZWjk5b21CaHp2L0NKK09tMm9qTndlQXNUWktuV3JIbFAyT081VWZ5RVZSZldvLyJdfQ.eyIkc2NoZW1hIjoiaHR0cDovL2pzb24tc2NoZW1hLm9yZy9kcmFmdC8yMDE5LTA5L3NjaGVtYSIsIlRpdGxlIjoiU2VjdXJlIENvbXBvbmVudCBWZXJpZmljYXRpb24gQ2VydGlmaWNhdGUgU3BlY2lmaWNhdGlvbiIsIlNUQVRJQyI6eyJDT01NT05fTkFNRSI6IlBvd2VyRWRnZSBTZWN1cmVkIENvbXBvbmVudCBWZXJpZmljYXRpb24gQ2VydGlmaWNhdGUiLCJPUkdfTkFNRSI6IkRlbGwgVGVjaG5vbG9naWVzIEluYy4iLCJVTklUX05BTUUiOiJQb3dlckVkZ2UiLCJDT1VOVFJZIjoiVVMiLCJTVEFURSI6IlRYIn0sIlBsYXRmb3JtUHJvcGVydGllcyI6eyJEZXNjcmlwdGlvbiI6eyJkZXNjcmlwdGlvbiI6IkRlbGwgUGxhdGZvcm0gQ2VydGlmaWNhdGUgUHJvZmlsZSBmb3IgUG93ZXJFZGdlIFNlcnZlcnMifSwiUHJvZmlsZSBWZXJzaW9uIjp7InByb2ZpbGVfdmVyc2lvbiI6IjEuNSJ9LCJQcm9maWxlIE5hbWUiOnsicHJvZmlsZV9uYW1lIjoiUG93ZXJFZGdlIn19LCJQbGF0Zm9ybUNlcnRpZmljYXRlRXh0ZW5zaW9ucyI6eyJDZXJ0aWZpY2F0ZVR5cGUiOnsiT0lEIjoiMi4yMy4xMzMuOC40In0sIlBsYXRmb3JtQ2VydGlmaWNhdGVUeXBlIjp7Ik9JRCI6IjIuMjMuMTMzLjIuMjUifSwiUGxhdGZvcm1Db25maWd1cmF0aW9uVmVyc2lvbiI6eyJPSUQiOiIyLjIzLjEzMy41LjEuNy4yIn0sIlBsYXRmb3JtU3BlY2lmaWNhdGlvbiI6eyJPSUQiOiIyLjIzLjEzMy4yLjE5In19LCJQbGF0Zm9ybUNvbmZpZ3VyYXRpb24iOnsiQ29tcG9uZW50RGV0YWlscyI6W3siU3lzdGVtSW5mb3JtYXRpb24iOnsiTWV0YWRhdGEiOnsiQ29tcG9uZW50Q2xhc3NSZWdpc3RyeU9JRCI6IjIuMjMuMTMzLjE4LjMuMSIsIkNvbXBvbmVudENsYXNzVmFsdWUiOiIweDAwMDIwMDAxIiwiUGxhdGZvcm1NYW51ZmFjdHVyZXJPSUQiOiIyLjIzLjEzMy41LjEuMSIsIlBsYXRmb3JtTW9kZWxPSUQiOiIyLjIzLjEzMy41LjEuNCIsIlBsYXRmb3JtU2VyaWFsT0lEIjoiMi4yMy4xMzMuNS4xLjYiLCJQbGF0Zm9ybVZlcnNpb25PSUQiOiIyLjIzLjEzMy41LjEuNSJ9LCJwcm9wZXJ0aWVzIjpbeyJDb21wYXJlVUlEIjpmYWxzZSwiTmFtZSI6Im1hbnVmYWN0dXJlciJ9LHsiQ29tcGFyZVVJRCI6ZmFsc2UsIk5hbWUiOiJtb2RlbCJ9LHsiQ29tcGFyZVVJRCI6ZmFsc2UsIk5hbWUiOiJod192ZXJzaW9uX251bWJlciJ9LHsiQ29tcGFyZVVJRCI6dHJ1ZSwiTmFtZSI6InNlcmlhbF9udW1iZXIifV19fSx7IkJhc2Vib2FyZCI6eyJNZXRhZGF0YSI6eyJDb21wb25lbnRDbGFzc1JlZ2lzdHJ5T0lEIjoiMi4yMy4xMzMuMTguMy4xIiwiQ29tcG9uZW50Q2xhc3NWYWx1ZSI6IjB4MDAwMzAwMDMifSwicHJvcGVydGllcyI6W3siQ29tcGFyZVVJRCI6ZmFsc2UsIk5hbWUiOiJtYW51ZmFjdHVyZXIifSx7IkNvbXBhcmVVSUQiOmZhbHNlLCJOYW1lIjoibW9kZWwifSx7IkNvbXBhcmVVSUQiOnRydWUsIk5hbWUiOiJzZXJpYWxfbnVtYmVyIn0seyJDb21wYXJlVUlEIjpmYWxzZSwiTmFtZSI6Imh3X3ZlcnNpb25fbnVtYmVyIn0seyJDb21wYXJlVUlEIjpmYWxzZSwiTmFtZSI6ImxvY2F0aW9uIn0seyJDb21wYXJlVUlEIjpmYWxzZSwiTmFtZSI6ImNlcnRpZmljYXRlX2lkZW50aWZpZXIifV19fSx7IlByb2Nlc3NvciI6eyJNZXRhZGF0YSI6eyJDb21wb25lbnRDbGFzc1JlZ2lzdHJ5T0lEIjoiMi4yMy4xMzMuMTguMy4xIiwiQ29tcG9uZW50Q2xhc3NWYWx1ZSI6IjB4MDAwMTAwMDIifSwicHJvcGVydGllcyI6W3siQ29tcGFyZVVJRCI6ZmFsc2UsIk5hbWUiOiJtYW51ZmFjdHVyZXIifSx7IkNvbXBhcmVVSUQiOmZhbHNlLCJOYW1lIjoibW9kZWwifSx7IkNvbXBhcmVVSUQiOnRydWUsIk5hbWUiOiJzZXJpYWxfbnVtYmVyIn0seyJDb21wYXJlVUlEIjpmYWxzZSwiTmFtZSI6Imh3X3ZlcnNpb25fbnVtYmVyIn0seyJDb21wYXJlVUlEIjpmYWxzZSwiTmFtZSI6ImxvY2F0aW9uIn0seyJDb21wYXJlVUlEIjpmYWxzZSwiTmFtZSI6ImNlcnRpZmljYXRlX2lkZW50aWZpZXIifV19fSx7Ik1lbW9yeSI6eyJNZXRhZGF0YSI6eyJDb21wb25lbnRDbGFzc1JlZ2lzdHJ5T0lEIjoiMi4yMy4xMzMuMTguMy4xIiwiQ29tcG9uZW50Q2xhc3NWYWx1ZSI6IjB4MDAwNjAwMDEifSwicHJvcGVydGllcyI6W3siQ29tcGFyZVVJRCI6ZmFsc2UsIk5hbWUiOiJtYW51ZmFjdHVyZXIifSx7IkNvbXBhcmVVSUQiOmZhbHNlLCJOYW1lIjoibW9kZWwifSx7IkNvbXBhcmVVSUQiOnRydWUsIk5hbWUiOiJzZXJpYWxfbnVtYmVyIn0seyJDb21wYXJlVUlEIjpmYWxzZSwiTmFtZSI6Imh3X3ZlcnNpb25fbnVtYmVyIn0seyJDb21wYXJlVUlEIjpmYWxzZSwiTmFtZSI6ImxvY2F0aW9uIn0seyJDb21wYXJlVUlEIjpmYWxzZSwiTmFtZSI6ImNlcnRpZmljYXRlX2lkZW50aWZpZXIifV19fSx7IlBvd2VyU3VwcGx5Ijp7Ik1ldGFkYXRhIjp7IkNvbXBvbmVudENsYXNzUmVnaXN0cnlPSUQiOiIyLjIzLjEzMy4xOC4zLjEiLCJDb21wb25lbnRDbGFzc1ZhbHVlIjoiMHgwMDBBMDAwMiJ9LCJwcm9wZXJ0aWVzIjpbeyJDb21wYXJlVUlEIjpmYWxzZSwiTmFtZSI6Im1hbnVmYWN0dXJlciJ9LHsiQ29tcGFyZVVJRCI6ZmFsc2UsIk5hbWUiOiJtb2RlbCJ9LHsiQ29tcGFyZVVJRCI6dHJ1ZSwiTmFtZSI6InNlcmlhbF9udW1iZXIifSx7IkNvbXBhcmVVSUQiOmZhbHNlLCJOYW1lIjoiaHdfdmVyc2lvbl9udW1iZXIifSx7IkNvbXBhcmVVSUQiOmZhbHNlLCJOYW1lIjoibG9jYXRpb24ifSx7IkNvbXBhcmVVSUQiOmZhbHNlLCJOYW1lIjoiY2VydGlmaWNhdGVfaWRlbnRpZmllciJ9XX19LHsiSGFyZERyaXZlIjp7Ik1ldGFkYXRhIjp7IkNvbXBvbmVudENsYXNzUmVnaXN0cnlPSUQiOiIyLjIzLjEzMy4xOC4zLjEiLCJDb21wb25lbnRDbGFzc1ZhbHVlIjoiMHgwMDA3MDAwMiJ9LCJwcm9wZXJ0aWVzIjpbeyJDb21wYXJlVUlEIjpmYWxzZSwiTmFtZSI6Im1hbnVmYWN0dXJlciJ9LHsiQ29tcGFyZVVJRCI6ZmFsc2UsIk5hbWUiOiJtb2RlbCJ9LHsiQ29tcGFyZVVJRCI6dHJ1ZSwiTmFtZSI6InNlcmlhbF9udW1iZXIifSx7IkNvbXBhcmVVSUQiOmZhbHNlLCJOYW1lIjoiaHdfdmVyc2lvbl9udW1iZXIifSx7IkNvbXBhcmVVSUQiOmZhbHNlLCJOYW1lIjoibG9jYXRpb24ifSx7IkNvbXBhcmVVSUQiOmZhbHNlLCJOYW1lIjoiY2VydGlmaWNhdGVfaWRlbnRpZmllciJ9XX19LHsiTmV0d29yayI6eyJNZXRhZGF0YSI6eyJDb21wb25lbnRDbGFzc1JlZ2lzdHJ5T0lEIjoiMi4yMy4xMzMuMTguMy4xIiwiQ29tcG9uZW50Q2xhc3NWYWx1ZSI6IjB4MDAwOTAwMDIifSwicHJvcGVydGllcyI6W3siQ29tcGFyZVVJRCI6ZmFsc2UsIk5hbWUiOiJtYW51ZmFjdHVyZXIifSx7IkNvbXBhcmVVSUQiOmZhbHNlLCJOYW1lIjoibW9kZWwifSx7IkNvbXBhcmVVSUQiOnRydWUsIk5hbWUiOiJzZXJpYWxfbnVtYmVyIn0seyJDb21wYXJlVUlEIjpmYWxzZSwiTmFtZSI6Imh3X3ZlcnNpb25fbnVtYmVyIn0seyJDb21wYXJlVUlEIjpmYWxzZSwiTmFtZSI6Im1hY19hZGRyZXNzIn0seyJDb21wYXJlVUlEIjpmYWxzZSwiTmFtZSI6ImxvY2F0aW9uIn0seyJDb21wYXJlVUlEIjpmYWxzZSwiTmFtZSI6ImNlcnRpZmljYXRlX2lkZW50aWZpZXIifV19fSx7ImlEUkFDIjp7Ik1ldGFkYXRhIjp7IkNvbXBvbmVudENsYXNzUmVnaXN0cnlPSUQiOiIyLjIzLjEzMy4xOC4zLjEiLCJDb21wb25lbnRDbGFzc1ZhbHVlIjoiMHgwMDA2MDAwMyJ9LCJwcm9wZXJ0aWVzIjpbeyJDb21wYXJlVUlEIjpmYWxzZSwiTmFtZSI6Im1hbnVmYWN0dXJlciJ9LHsiQ29tcGFyZVVJRCI6ZmFsc2UsIk5hbWUiOiJtb2RlbCJ9LHsiQ29tcGFyZVVJRCI6dHJ1ZSwiTmFtZSI6InNlcmlhbF9udW1iZXIifSx7IkNvbXBhcmVVSUQiOmZhbHNlLCJOYW1lIjoiaHdfdmVyc2lvbl9udW1iZXIifSx7IkNvbXBhcmVVSUQiOmZhbHNlLCJOYW1lIjoibWFjX2FkZHJlc3MifSx7IkNvbXBhcmVVSUQiOmZhbHNlLCJOYW1lIjoibG9jYXRpb24ifSx7IkNvbXBhcmVVSUQiOmZhbHNlLCJOYW1lIjoiY2VydGlmaWNhdGVfaWRlbnRpZmllciJ9XX19LHsiVFBNIjp7Ik1ldGFkYXRhIjp7IkNvbXBvbmVudENsYXNzUmVnaXN0cnlPSUQiOiIyLjIzLjEzMy4xOC4zLjEiLCJDb21wb25lbnRDbGFzc1ZhbHVlIjoiMHgwMDA0MDAwOSJ9LCJwcm9wZXJ0aWVzIjpbeyJDb21wYXJlVUlEIjpmYWxzZSwiTmFtZSI6Im1hbnVmYWN0dXJlciJ9LHsiQ29tcGFyZVVJRCI6ZmFsc2UsIk5hbWUiOiJtb2RlbCJ9LHsiQ29tcGFyZVVJRCI6dHJ1ZSwiTmFtZSI6InNlcmlhbF9udW1iZXIifSx7IkNvbXBhcmVVSUQiOmZhbHNlLCJOYW1lIjoiaHdfdmVyc2lvbl9udW1iZXIifSx7IkNvbXBhcmVVSUQiOmZhbHNlLCJOYW1lIjoibG9jYXRpb24ifSx7IkNvbXBhcmVVSUQiOmZhbHNlLCJOYW1lIjoiY2VydGlmaWNhdGVfaWRlbnRpZmllciJ9XX19LHsiUENJRSI6eyJNZXRhZGF0YSI6eyJDb21wb25lbnRDbGFzc1JlZ2lzdHJ5T0lEIjoiMi4yMy4xMzMuMTguMy4xIiwiQ29tcG9uZW50Q2xhc3NWYWx1ZSI6IjB4MDAwNTAwMDAifSwicHJvcGVydGllcyI6W3siQ29tcGFyZVVJRCI6ZmFsc2UsIk5hbWUiOiJtYW51ZmFjdHVyZXIifSx7IkNvbXBhcmVVSUQiOmZhbHNlLCJOYW1lIjoibW9kZWwifSx7IkNvbXBhcmVVSUQiOnRydWUsIk5hbWUiOiJzZXJpYWxfbnVtYmVyIn0seyJDb21wYXJlVUlEIjpmYWxzZSwiTmFtZSI6Imh3X3ZlcnNpb25fbnVtYmVyIn0seyJDb21wYXJlVUlEIjpmYWxzZSwiTmFtZSI6ImxvY2F0aW9uIn0seyJDb21wYXJlVUlEIjpmYWxzZSwiTmFtZSI6ImNlcnRpZmljYXRlX2lkZW50aWZpZXIifV19fV19fQ.hX6IFCKFoRoCJeft82VbODYZk6kUtE1Nn-h536HzMQydyFLnpMHc0cDsuPKzAmCvFxf5jAvmIVFNs0mlcTeEmw"

public_key = open('es384pub.pem', 'r').read()
print( jwt.decode(jwt=sign_mod, key=public_key, algorithms=['ES384', ],verify = False))

print(jwt.get_unverified_header(sign_mod))'''